!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("strings",[],t):"object"==typeof exports?exports.strings=t():e.strings=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return a(e,null,[{key:"frequenciesToCents",value:function(e,t){return Math.isEqual(e,0)?0:Math.log(t/e)/Math.log(2)*1200}},{key:"frequencyToCents",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:440;return e.frequenciesToCents(n,t)+900}},{key:"centsToFrequency",value:function(e,t){return t*Math.pow(2,e/1200)}},{key:"centsToStringLength",value:function(e){return 1/Math.pow(2,e/1200)}},{key:"frequencyToStringLength",value:function(e,t){if(Math.isEqual(e,0))throw new Error("Invalid frequency: "+e);var n=this.frequenciesToCents(t,e);return this.centsToStringLength(n)}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Note=t.Instrument=t.HarmonicCalculator=t.Harmonic=void 0;var a=n(2),o=r(a),u=n(4),i=r(u),l=n(5),f=r(l),c=n(6),s=r(c);s.default.ACCIDENTALS=c.ACCIDENTALS,t.Harmonic=o.default,t.HarmonicCalculator=i.default,t.Instrument=f.default,t.Note=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),i=r(u),l=n(3),f=r(l),c=function(){function e(t,n,r){if(a(this,e),t>n)throw new Error("The half-stop cannot be lower than the base stop.");this.halfStop=t,this.baseStop=n,this.stringFrequency=r}return o(e,[{key:"number",get:function(){var e=f.default.round(1/f.default.gcd(1,this.halfStop/this.baseStop));return Object.defineProperty(this,"number",{value:e,writable:!1}),e}},{key:"isNatural",get:function(){return f.default.isEqual(this.baseStop,1)}},{key:"frequency",get:function(){var t=e.getSoundingFrequency(this.number,this.baseStop,this.stringFrequency);return Object.defineProperty(this,"frequency",{value:t,writable:!1}),t}}],[{key:"getSoundingFrequency",value:function(e,t,n){var r=i.default.frequenciesToCents(t,1);return i.default.centsToFrequency(r,n)*e}},{key:"getStringLengthsFromNumber",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=1;r<=e;r++)t&&1!==r&&!f.default.isEqual(f.default.gcd(r,e),1)||n.push(r/e);return n}},{key:"getSeries",value:function(e){for(var t=[],n=0,r=1;r<=e;r++)n=t[r]=n+1/r;return t}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Math.pow(2,-32);Math.isEqual=function(e,t){return Math.abs(e-t)<r},Math.isGreaterThan=function(e,t){return e>t&&e-t>r},Math.gcd=function(e,t){return this.isEqual(t,0)?e:this.gcd(t,e%t)},Math.toNearest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t},Math.toDecimalPlaces=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return Math.round(e);var n=this.pow(10,t);return Math.round(e*n)/n},t.default=Math,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){return(e.baseStop-e.halfStop)*t.stringLength}function i(e,t){return e.halfStop*t.stringLength}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),c=r(f),s=n(2),h=r(s),d=n(3),v=r(d),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.minStopDistance,r=void 0===n?1:n,a=t.maxStopDistance,u=void 0===a?120:a,i=t.minBowedDistance,l=void 0===i?20:i,f=t.maxSoundingNoteDifference,c=void 0===f?50:f;o(this,e),this.minStopDistance=r,this.maxStopDistance=u,this.minBowedDistance=l,this.maxSoundingNoteDifference=c}return l(e,[{key:"findArtificialHarmonics",value:function(e,t){for(var n=[],r=e.getFrequency(),a=2;a<=6;a++){var o=r/a;if(v.default.isGreaterThan(o,t)){var u=c.default.frequencyToStringLength(o,t),i=(a-1)/a*u;n.push(new h.default(i,u,t))}}return n}},{key:"findNaturalHarmonics",value:function(e,t){for(var n=[],r=1;r<=8;r++){var a=h.default.getSoundingFrequency(1,1/r,t);if(v.default.abs(c.default.frequencyToCents(a)-e.cents)<=this.maxSoundingNoteDifference){var o=!0,u=!1,i=void 0;try{for(var l,f=h.default.getStringLengthsFromNumber(r,!0)[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var s=l.value;n.push(new h.default(s,1,t))}}catch(e){u=!0,i=e}finally{try{!o&&f.return&&f.return()}finally{if(u)throw i}}}}return n}},{key:"validatePhysicalDistance",value:function(e,t){if(!e.isNatural){var n=u(e,t);if(n<this.minStopDistance||n>this.maxStopDistance)return!1}return i(e,t)>=this.minBowedDistance}},{key:"findHarmonics",value:function(e,t){var n=this,r=[],o=!0,u=!1,i=void 0;try{for(var l,f=t.stringFrequencies[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var c,s=l.value;(c=r).push.apply(c,a(this.findNaturalHarmonics(e,s)).concat(a(this.findArtificialHarmonics(e,s))))}}catch(e){u=!0,i=e}finally{try{!o&&f.return&&f.return()}finally{if(u)throw i}}return r=r.filter(function(e){return n.validatePhysicalDistance(e,t)})}}]),e}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.presets=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),u=t.presets={violin:{names:["E5","A4","D4","G3"],length:325},viola:{names:["A4","D4","G3","C3"],length:410},cello:{names:["A3","D3","G2","C2"],length:690},"double bass":{names:["G2","D2","A1","E1"],length:1140}},i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;r(this,e),this.stringFrequencies=t,this.stringLength=n}return a(e,null,[{key:"fromNames",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=[],r=!0,a=!1,u=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var f=i.value;n.push(o.Note.fromName(f).getFrequency())}}catch(e){a=!0,u=e}finally{try{!r&&l.return&&l.return()}finally{if(a)throw u}}return new this(n,t)}},{key:"fromPreset",value:function(e){if(void 0===u[e])throw new Error("Preset not found: "+e);return this.fromNames(u[e].names,u[e].length)}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.ACCIDENTALS=void 0;var u,i,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(c),h=t.ACCIDENTALS={none:"",natural:"♮",sharp:"♯",flat:"♭",doubleSharp:"x",doubleFlat:"♭♭",quarterSharp:"¼♯",quarterFlat:"¼♭",threeQuarterSharp:"¾♯",threeQuarterFlat:"¾♭"},d=/^ *[a-g]/i,v=new RegExp("[/ ]? *(-?[0-9]+)\\b"),p=new RegExp("([+-][0-9]+(.[0-9]+)?) *[c¢]","iu"),y=(u={},o(u,"",h.none),o(u,"([♮n]|nat(ural)?)",h.natural),o(u,"([♭fb]|fl(at)?)",h.flat),o(u,"([♯s#]|sh(arp)?)",h.sharp),o(u,"(-|(q|quarter|¼|1/4)[ -]?([♭fb]|fl(at)?))",h.quarterFlat),o(u,"(\\+|(q|quarter|¼|1/4)[ -]?([♯s#]|sh(arp)?))",h.quarterSharp),o(u,"(𝄫|bb|double[ -]([♭fb]|fl(at)?))",h.doubleFlat),o(u,"(𝄪|♯♯|##|double[ -]([♯s#]|sh(arp)?))",h.doubleSharp),o(u,"(([♭fb]|fl(at)?)-|((three|3)[ -]q|quarter|¾|3/4)[ -]?([♭fb]|fl(at)?))",h.threeQuarterFlat),o(u,"(([♯s#]|sh(arp)?)\\+|((three|3)[ -]q|quarter|¾|3/4)[ -]?([♯s#]|sh(arp)?))",h.threeQuarterSharp),u),g=function(e){e=e.trim();for(var t in y){var n=y[t];if(e===n||new RegExp("^"+t+"$","iu").test(e))return n}throw new Error("Invalid accidental: "+e)},b=(i={},o(i,h.none,0),o(i,h.natural,0),o(i,h.flat,-100),o(i,h.sharp,100),o(i,h.quarterFlat,-50),o(i,h.quarterSharp,50),o(i,h.doubleFlat,-200),o(i,h.doubleSharp,200),o(i,h.threeQuarterFlat,-150),o(i,h.threeQuarterSharp,150),i),m={C:0,D:200,E:400,F:500,G:700,A:900,B:1100},w=[h.none,h.natural,h.sharp,h.flat,h.quarterSharp,h.quarterFlat,h.doubleSharp,h.doubleFlat,h.threeQuarterSharp,h.threeQuarterFlat],S=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(a(this,e),r>1e3)throw new Error("Invalid octave: "+r);this.name=t,this.accidental=n,this.octave=r,this.difference=o}return f(e,[{key:"toString",value:function(){var e=this.name+this.accidental+"/"+this.octave;return Math.isEqual(this.difference,0)||(e+=" "+(this.difference>0?"+":"")+this.difference+"¢"),e}},{key:"getFrequency",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:440;return s.default.centsToFrequency(this.cents-900,e)}},{key:"cents",get:function(){return m[this.name]+b[this.accidental]+1200*(this.octave-4)+this.difference}}],[{key:"fromCents",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=Math.toNearest(t,50),o=Math.toDecimalPlaces(t-a,2),u=Math.floor(a/1200)+4,i=a-1200*(u-4),f=Object.keys(m);1!==n.length||n[0]!==h.none&&n[0]!==h.natural||n.push(h.flat,h.quarterFlat);for(var c=[].concat(r(n),w),s=0;s<c.length;s++){var d=function(){var t=c[s],n=i-b[t],r=f.find(function(e){return m[e]===n});if(void 0!==r)return{v:new e(r,t,u,o)}}();if("object"===(void 0===d?"undefined":l(d)))return d.v}throw new Error("Failed to find note name for cents: "+t)}},{key:"fromFrequency",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:440,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.fromCents(s.default.frequencyToCents(t,n),r)}},{key:"fromName",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.octave,a=void 0===r?4:r,o=n.accidental,u=void 0===o?h.none:o,i=n.difference,l=void 0===i?0:i,f=t,c=f.match(d);if(null===c)throw new Error("Invalid note name: "+t);var s=c[0].toUpperCase();if(f=f.replace(d,"").trim(),null!==(c=f.match(/^([+-])[0-9]+$/)))throw new Error("Ambiguous note: "+t+' (is "'+c[1]+'" an accidental?)');if(c=f.match(p),null!==c&&(l=c[1],f=f.replace(p,"").trim()),c=f.match(v),null!==c&&(a=parseInt(c[1],10),f=f.replace(v,"").trim()),l>=1200){var y=Math.round(l/1200);a+=y,l-=1200*y}return u=g(f?f:u),new e(s,u,a,Math.toDecimalPlaces(l,2))}}]),e}();t.default=S}])});