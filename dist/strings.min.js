!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("strings",[],t):"object"==typeof exports?exports.strings=t():e.strings=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,r){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t){o(this,e),this.message=t||this.constructor.name,this.stack=(new Error).stack};i.prototype=Object.create(Error.prototype);var u=function(e){function t(){return o(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(i),l=function(e){function t(){return o(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(i);t.InvalidArgumentError=u,t.RuntimeError=l},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),i=function(){function e(){n(this,e)}return a(e,null,[{key:"frequenciesToCents",value:function(e,t){return Math.isEqual(e,0)?0:Math.log(t/e)/Math.log(2)*1200}},{key:"frequencyToCents",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:440;return e.frequenciesToCents(r,t)+900}},{key:"centsToFrequency",value:function(e,t){return t*Math.pow(2,e/1200)}},{key:"centsToStringLength",value:function(e){return 1/Math.pow(2,e/1200)}},{key:"frequencyToStringLength",value:function(e,t){if(Math.isEqual(e,0))throw new o.InvalidArgumentError("Invalid (zero) frequency: "+e);var r=this.frequenciesToCents(t,e);return this.centsToStringLength(r)}}]),e}();t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),u=n(i),l=r(3),f=n(l),c=r(0),s=function(){function e(t,r,n){if(a(this,e),t>r)throw new c.InvalidArgumentError("The half-stop cannot be lower than the base stop.");this.halfStop=t,this.baseStop=r,this.stringFrequency=n}return o(e,[{key:"number",get:function(){var e=f.default.round(1/f.default.gcd(1,this.halfStop/this.baseStop));return Object.defineProperty(this,"number",{value:e,writable:!1}),e}},{key:"isNatural",get:function(){return f.default.isEqual(this.baseStop,1)}},{key:"isOpenString",get:function(){return f.default.isEqual(this.halfStop,1)&&f.default.isEqual(this.baseStop,1)}},{key:"frequency",get:function(){var t=e.getSoundingFrequency(this.number,this.baseStop,this.stringFrequency);return Object.defineProperty(this,"frequency",{value:t,writable:!1}),t}}],[{key:"getSoundingFrequency",value:function(e,t,r){var n=u.default.frequenciesToCents(t,1);return u.default.centsToFrequency(n,r)*e}},{key:"getStringLengthsFromNumber",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=1;n<=e;n++)t&&1!==n&&!f.default.isEqual(f.default.gcd(n,e),1)||r.push(n/e);return r}}]),e}();t.default=s,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});Math.isEqual=function(e,t){return Math.abs(e-t)<1e-10},Math.isGreaterThan=function(e,t){return e>t&&e-t>1e-10},Math.gcd=function(e,t){return this.isEqual(t,0)?e:this.gcd(t,e%t)},Math.toNearest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t},Math.toDecimalPlaces=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return Math.round(e);var r=this.pow(10,t);return Math.round(e*r)/r},t.default=Math,e.exports=t.default},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.ACCIDENTALS=void 0;var i,u,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(1),s=function(e){return e&&e.__esModule?e:{default:e}}(c),h=r(0),d=t.ACCIDENTALS={none:"",natural:"♮",sharp:"♯",flat:"♭",doubleSharp:"x",doubleFlat:"♭♭",quarterSharp:"¼♯",quarterFlat:"¼♭",threeQuarterSharp:"¾♯",threeQuarterFlat:"¾♭"},v=new RegExp("^ *[a-g]","i"),p=new RegExp("[/ ]*([-]? *[0-9]+)"),y=new RegExp("([+-]? *[0-9]+(.[0-9]+)?) *(c(ent)?s?|¢)","iu"),g=(i={},o(i,d.none,""),o(i,d.natural,"([♮n]|nat(ural)?)"),o(i,d.flat,"([♭fb]|fl(at)?)"),o(i,d.sharp,"([♯s#]|sh(arp)?)"),o(i,d.quarterFlat,"(d|-|(q|quarter|¼|1/4)[ -]?([♭fb]|fl(at)?))"),o(i,d.quarterSharp,"(\\+|(q|quarter|¼|1/4)[ -]?([♯s#]|sh(arp)?))"),o(i,d.doubleFlat,"(𝄫|bb|double[ -]([♭fb]|fl(at)?))"),o(i,d.doubleSharp,"(𝄪|♯♯|##|double[ -]([♯s#]|sh(arp)?))"),o(i,d.threeQuarterFlat,"(db|([♭fb]|fl(at)?)-|((three|3)[ -]q|quarter|¾|3/4)[ -]?([♭fb]|fl(at)?))"),o(i,d.threeQuarterSharp,"(\\+\\+|([♯s#]|sh(arp)?)\\+|((three|3)[ -]q|quarter|¾|3/4)[ -]?([♯s#]|sh(arp)?))"),i),b=function(e){e=e.trim();for(var t in g)if(e===t||new RegExp("^"+g[t]+"$","iu").test(e))return t;throw new h.InvalidArgumentError('Invalid accidental: "'+e+'"')},m=(u={},o(u,d.none,0),o(u,d.natural,0),o(u,d.flat,-100),o(u,d.sharp,100),o(u,d.quarterFlat,-50),o(u,d.quarterSharp,50),o(u,d.doubleFlat,-200),o(u,d.doubleSharp,200),o(u,d.threeQuarterFlat,-150),o(u,d.threeQuarterSharp,150),u),w={C:0,D:200,E:400,F:500,G:700,A:900,B:1100},S=[d.none,d.natural,d.sharp,d.flat,d.quarterSharp,d.quarterFlat,d.doubleSharp,d.doubleFlat,d.threeQuarterSharp,d.threeQuarterFlat],q=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(a(this,e),n>1e3)throw new h.InvalidArgumentError("Invalid octave: "+n);this.name=t,this.accidental=r,this.octave=n,this.difference=o}return f(e,[{key:"toString",value:function(){var e=this.name+this.accidental+this.octave;return Math.isEqual(this.difference,0)||(e+=" "+(this.difference>0?"+":"")+this.difference+"¢"),e}},{key:"getFrequency",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:440;return s.default.centsToFrequency(this.cents-900,e)}},{key:"cents",get:function(){return w[this.name]+m[this.accidental]+1200*(this.octave-4)+this.difference}}],[{key:"fromCents",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=Math.toNearest(t,50),o=Math.toDecimalPlaces(t-a,2),i=Math.floor(a/1200)+4,u=a-1200*(i-4),f=Object.keys(w);1!==r.length||r[0]!==d.none&&r[0]!==d.natural||r.push(d.flat,d.quarterFlat);for(var c=[].concat(n(r),S),s=0;s<c.length;s++){var v=function(){var t=c[s],r=u-m[t],n=f.find(function(e){return w[e]===r});if(void 0!==n)return{v:new e(n,t,i,o)}}();if("object"===(void 0===v?"undefined":l(v)))return v.v}throw new h.RuntimeError("Failed to find note name for cents: "+t)}},{key:"fromFrequency",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:440,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.fromCents(s.default.frequencyToCents(t,r),n)}},{key:"fromName",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.octave,a=void 0===n?4:n,o=r.accidental,i=void 0===o?d.none:o,u=r.difference,l=void 0===u?0:u,f=t,c=f.match(v);if(null===c)throw new h.InvalidArgumentError('Invalid note: "'+t+'" (it should start with a letter, A-G)');var s=c[0].toUpperCase();f=f.replace(v,"").trim();var g=/ +/;c=f.match(y),null!==c&&(l=c[1].replace(g,""),f=f.replace(y,"").trim()),c=f.match(p),null!==c&&(a=parseInt(c[1].replace(g,""),10),f=f.replace(p,"").trim()),i=f||i;try{i=b(i)}catch(e){if(e instanceof h.InvalidArgumentError)throw new h.InvalidArgumentError('Invalid note: "'+t+'" (unrecognised: "'+i+'")');throw e}if(l>=1200){var m=Math.round(l/1200);a+=m,l-=1200*m}return new e(s,i,a,Math.toDecimalPlaces(l,2))}}]),e}();t.default=q},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Note=t.InstrumentString=t.Instrument=t.HarmonicCalculator=t.Harmonic=void 0;var a=r(2),o=n(a),i=r(6),u=n(i),l=r(7),f=n(l),c=r(8),s=n(c),h=r(4),d=n(h);d.default.ACCIDENTALS=h.ACCIDENTALS,t.Harmonic=o.default,t.HarmonicCalculator=u.default,t.Instrument=f.default,t.InstrumentString=s.default,t.Note=d.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return(e.baseStop-e.halfStop)*t}function u(e,t){return e.halfStop*t}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=r(1),c=n(f),s=r(2),h=n(s),d=r(3),v=n(d),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.minStopDistance,n=void 0===r?1:r,a=t.maxStopDistance,i=void 0===a?120:a,u=t.minBowedDistance,l=void 0===u?20:u,f=t.maxSoundingNoteDifference,c=void 0===f?50:f;o(this,e),this.minStopDistance=n,this.maxStopDistance=i,this.minBowedDistance=l,this.maxSoundingNoteDifference=c}return l(e,[{key:"findArtificialHarmonics",value:function(e,t){for(var r=[],n=e.getFrequency(),a=2;a<=6;a++){var o=n/a;if(v.default.isGreaterThan(o,t)){var i=c.default.frequencyToStringLength(o,t),u=(a-1)/a*i;r.push(new h.default(u,i,t))}}return r}},{key:"findNaturalHarmonics",value:function(e,t){for(var r=[],n=1;n<=16;n++){var a=h.default.getSoundingFrequency(1,1/n,t);if(v.default.abs(c.default.frequencyToCents(a)-e.cents)<=this.maxSoundingNoteDifference){var o=!0,i=!1,u=void 0;try{for(var l,f=h.default.getStringLengthsFromNumber(n,!0)[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var s=l.value;r.push(new h.default(s,1,t))}}catch(e){i=!0,u=e}finally{try{!o&&f.return&&f.return()}finally{if(i)throw u}}}}return r}},{key:"validatePhysicalDistance",value:function(e,t){if(!e.isNatural){var r=i(e,t);if(r<this.minStopDistance||r>this.maxStopDistance)return!1}return u(e,t)>=this.minBowedDistance}},{key:"findHarmonics",value:function(e,t){var r,n=this,o=[];return(r=o).push.apply(r,a(this.findNaturalHarmonics(e,t.frequency)).concat(a(this.findArtificialHarmonics(e,t.frequency)))),o=o.filter(function(e){return n.validatePhysicalDistance(e,t.physicalLength)})}},{key:"findHarmonicsForInstrument",value:function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var u,l=t.strings[Symbol.iterator]();!(n=(u=l.next()).done);n=!0){var f=u.value;r.push.apply(r,a(this.findHarmonics(e,f)))}}catch(e){o=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw i}}return r}}]),e}();t.default=p,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.presets=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(4),u=n(i),l=r(0),f=r(8),c=n(f),s=t.presets={violin:{names:["E5","A4","D4","G3"],length:325,clef:"treble"},viola:{names:["A4","D4","G3","C3"],length:410,clef:"alto"},cello:{names:["A3","D3","G2","C2"],length:690,clef:"bass"},"double bass":{names:["G2","D2","A1","E1"],length:1140,clef:"bass"}},h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"treble";a(this,e);var o=["I","II","III","IV","V","VI","VII","VIII","IX","X"];this.strings=[];for(var i in t)this.strings.push(new c.default(o[i],t[i],r));this.clef=n}return o(e,[{key:"getString",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,o=this.strings[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=a.value;if(i.number===e)return i}}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}throw new l.InvalidArgumentError("String not found: "+e)}}],[{key:"fromNames",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=arguments[2],n=[],a=!0,o=!1,i=void 0;try{for(var l,f=e[Symbol.iterator]();!(a=(l=f.next()).done);a=!0){var c=l.value;n.push(u.default.fromName(c).getFrequency())}}catch(e){o=!0,i=e}finally{try{!a&&f.return&&f.return()}finally{if(o)throw i}}return new this(n,t,r)}},{key:"fromPreset",value:function(e){if(void 0===s[e])throw new l.InvalidArgumentError("Preset not found: "+e);return this.fromNames(s[e].names,s[e].length,s[e].clef)}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;n(this,e),this.number=t,this.frequency=r,this.physicalLength=a};t.default=a,e.exports=t.default}])});